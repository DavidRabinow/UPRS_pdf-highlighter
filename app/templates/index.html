<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Enhanced Document Fill</title>
    <style>
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica,
          Arial, sans-serif;
        margin: 2rem;
      }
      .card {
        max-width: 800px;
        margin: auto;
        padding: 1.5rem;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
      }
      label {
        display: block;
        margin-top: 0.75rem;
        font-weight: 600;
      }
      input[type="text"],
      input[type="email"] {
        width: 100%;
        padding: 0.6rem;
        border: 1px solid #d1d5db;
        border-radius: 8px;
      }
      input[type="file"] {
        margin-top: 0.5rem;
      }
      button {
        margin-top: 1rem;
        padding: 0.75rem 1rem;
        border: 0;
        border-radius: 10px;
        background: black;
        color: white;
        font-weight: 600;
        cursor: pointer;
      }
      .hint {
        color: #6b7280;
        font-size: 0.9rem;
      }
      .flash {
        background: #fef3c7;
        color: #92400e;
        padding: 0.5rem;
        border-radius: 8px;
        margin-bottom: 1rem;
      }
      .field-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
      }
      .field-group label {
        margin-top: 0;
      }
      .section {
        margin-bottom: 2rem;
        padding: 1rem;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        background: #f9fafb;
      }
      .section h2 {
        margin-top: 0;
        color: #374151;
        font-size: 1.1rem;
      }
      .privacy-notice {
        background: #f3f4f6;
        padding: 0.75rem;
        border-radius: 6px;
        margin: 1rem 0;
        font-size: 0.9rem;
        color: #4b5563;
      }
      .highlight-section {
        background: #fef3c7;
        border: 2px solid #fbbf24;
        margin-top: 2rem;
      }
      .highlight-section h2 {
        color: #92400e;
      }
      .checkbox-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 0.75rem;
        margin-bottom: 1rem;
      }
      .checkbox-item {
        display: flex;
        align-items: center;
        padding: 0.5rem;
        background: white;
        border: 1px solid #fbbf24;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
      }
      .checkbox-item:hover {
        background: #fed7aa;
      }
      .checkbox-item input[type="checkbox"] {
        margin-right: 0.5rem;
        transform: scale(1.1);
      }
      .checkbox-item label {
        margin: 0;
        cursor: pointer;
        font-size: 0.9rem;
        color: #374151;
      }
      .custom-words {
        margin-top: 1rem;
      }
      .custom-words label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: #374151;
      }
      .custom-words textarea {
        width: 100%;
        min-height: 80px;
        padding: 0.75rem;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-family: inherit;
        resize: vertical;
      }
      .custom-words .hint {
        font-size: 0.8rem;
        color: #6b7280;
        margin-top: 0.5rem;
        text-align: left;
      }
      .highlight-button {
        background: #3b82f6;
        margin-top: 1rem;
      }
      .highlight-button:hover {
        background: #2563eb;
      }
    </style>
  </head>
  <body>
    <div class="card">
      {% with messages = get_flashed_messages() %} {% if messages %}
      <div class="flash">{{ messages[0] }}</div>
      {% endif %} {% endwith %}
      <h1>Enhanced Document Fill</h1>
      <p class="hint">
        Upload a .zip containing PDFs. Enter values to fill wherever the
        document has label anchors (e.g., "name:", "email:", etc.).
        <strong>Smart Detection:</strong> The system will automatically detect if fields are already filled (e.g., email with @ symbol, phone with digits) and skip them to preserve existing data.
      </p>
      <form method="post" action="/process" enctype="multipart/form-data">
        <div class="section">
          <h2>A. Claimant Information</h2>

          <label>Name if different than above</label>
          <input
            type="text"
            name="name_different"
            placeholder="DAVID RABINOW"
          />

          <label>Daytime Phone</label>
          <input
            type="text"
            name="daytime_phone"
            placeholder="(555) 123-4567"
          />

          <label>Current Address if different than above</label>
          <input
            type="text"
            name="current_address"
            placeholder="123 Main St, Springfield, IL"
          />

          <label>Email Address</label>
          <input type="email" name="email" placeholder="drabinow2@gmail.com" />

          <div class="field-group">
            <div>
              <label>Date of Birth</label>
              <input type="text" name="dob" placeholder="MM/DD/YYYY" />
            </div>
            <div>
              <label>SSN/FEIN</label>
              <input type="text" name="ssn_fein" placeholder="123-45-6789" />
            </div>
          </div>

          <div class="privacy-notice">
            <strong>PRIVACY PROTECTION:</strong> Please be assured that the
            Illinois State Treasurer does not use your social security number
            for any purpose other than to process your claim and fulfill the
            requirements of the Illinois Comptroller to issue a check for
            payment.
          </div>
          
          <div class="privacy-notice" style="background: #dbeafe; border-left: 4px solid #3b82f6;">
            <strong>SMART FIELD DETECTION:</strong> The system intelligently detects if fields are already filled:
            <ul style="margin: 0.5rem 0 0 1.5rem; padding: 0;">
              <li><strong>Email:</strong> Skips if @ symbol is detected</li>
              <li><strong>Phone:</strong> Skips if 7+ digits are found</li>
              <li><strong>SSN/EIN:</strong> Skips if proper format is detected</li>
              <li><strong>Address:</strong> Skips if substantial text is present</li>
            </ul>
          </div>
        </div>

        <label>ZIP with PDFs</label>
        <input type="file" name="zipfile" accept=".zip" required />

        <button type="submit">Process & Download</button>
      </form>

      <!-- Highlighting Section -->
      <div class="section highlight-section">
        <h2>‚úçÔ∏è Document Highlighting</h2>
        <p class="hint" style="text-align: left; margin-bottom: 1rem">
          Select words and phrases to highlight in your documents:
        </p>

        <form method="post" action="/highlight" enctype="multipart/form-data">
          <div class="checkbox-grid">
            {% for word in common_highlights %}
            <div class="checkbox-item">
              <input
                type="checkbox"
                id="word_{{ loop.index }}"
                name="highlight_words"
                value="{{ word }}"
              />
              <label for="word_{{ loop.index }}">{{ word }}</label>
            </div>
            {% endfor %}
          </div>

          <div class="custom-words">
            <label for="custom_words">Add Custom Words/Phrases:</label>
            <textarea
              id="custom_words"
              name="custom_words"
              placeholder="Enter additional words or phrases to highlight, separated by commas or new lines.&#10;Example:&#10;DAVID RABINOW&#10;BLUE STAR ENERGY&#10;363 WEST ERIE STREET"
            ></textarea>
            <p class="hint">
              Separate multiple words/phrases with commas, semicolons, or new
              lines.
            </p>
          </div>

          <label for="highlight_zipfile">üìÅ Upload ZIP File with PDFs:</label>
          <input
            type="file"
            id="highlight_zipfile"
            name="highlight_zipfile"
            accept=".zip"
            required
          />

          <button type="submit" class="highlight-button">
            ‚ú® Highlight Documents & Download
          </button>
        </form>
      </div>

      <p class="hint">
        Enhanced field detection with fuzzy matching and confidence scoring.
        Supports AcroForms and text-based field detection.
      </p>
    </div>
  </body>
</html>
